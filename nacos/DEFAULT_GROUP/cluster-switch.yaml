# 集群切换配置
cluster:
  switch:
    # 是否启用自动切换
    auto-switch-enabled: false
    
    # 切换策略
    strategy: MANUAL  # AUTO, MANUAL, SCHEDULED
    
    # 自动切换阈值
    thresholds:
      cpu-usage: 80  # CPU使用率阈值(%)
      memory-usage: 85  # 内存使用率阈值(%)
      response-time: 1000  # 响应时间阈值(ms)
      error-rate: 5  # 错误率阈值(%)
      throughput-drop: 30  # 吞吐量下降阈值(%)
      
    # 切换条件
    conditions:
      consecutive-failures: 3  # 连续失败次数
      failure-window: 60  # 失败时间窗口(秒)
      recovery-window: 300  # 恢复时间窗口(秒)
      
    # 切换操作
    operations:
      scale-up:
        enabled: true
        threshold: 70  # 触发扩容的阈值(%)
        max-replicas: 10  # 最大副本数
        scale-factor: 1.5  # 扩容因子
        
      scale-down:
        enabled: true
        threshold: 30  # 触发缩容的阈值(%)
        min-replicas: 1  # 最小副本数
        scale-factor: 0.5  # 缩容因子
        
    # 切换通知
    notification:
      enabled: true
      channels:
        - email
        - sms
        - webhook
      recipients:
        - admin@couponkill.com
        - ops@couponkill.com
        
    # 切换日志
    logging:
      enabled: true
      level: INFO
      retention-days: 30
      
    # 切换保护
    protection:
      enabled: true
      cooldown-period: 300  # 冷却期(秒)
      max-switches-per-hour: 10  # 每小时最大切换次数
      rollback-on-failure: true  # 失败时回滚
      
    # 切换测试
    testing:
      enabled: false
      canary-percentage: 10  # 金丝雀发布百分比(%)
      test-duration: 300  # 测试持续时间(秒)
      
    # 切换时间窗口
    time-windows:
      enabled: false
      windows:
        - start: "02:00"
          end: "04:00"
          days: [1, 3, 5]  # 周一、三、五
          
    # 切换审批
    approval:
      enabled: false
      approvers:
        - admin@couponkill.com
        - ops-lead@couponkill.com
        
    # 切换回滚策略
    rollback:
      enabled: true
      auto-rollback-after: 600  # 自动回滚时间(秒)
      rollback-threshold: 50  # 回滚阈值(%)