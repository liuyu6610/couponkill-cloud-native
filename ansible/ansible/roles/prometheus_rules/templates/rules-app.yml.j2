groups:
  - name: app.rules
    rules:
      - alert: AppHttp5xxRate
        expr: sum(rate(http_server_requests_seconds_count{status=~"5.."}[5m])) by (app,instance) > 0.5
        for: 5m
        labels: { severity: critical }
        annotations:
          summary: "5xx rate high for {{ $labels.app }} on {{ $labels.instance }}"

      - alert: AppLatencyP95
        expr: histogram_quantile(0.95, sum(rate(http_server_requests_seconds_bucket[5m])) by (le, app)) > 0.5
        for: 10m
        labels: { severity: warning }
        annotations:
          summary: "P95 latency high for {{ $labels.app }}"
